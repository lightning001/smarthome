<!DOCTYPE html">
<html>

<head>
	<% include ./partials/head %>
		<link rel="stylesheet" href="/css/home.css">
		<title><%=room.room_name  + ' - ' + req.session.user.name %></title>
</head>

<body>
	<% include ./partials/header %>
	<div class="space-medium">
		<div class="container-fluid main">
			<div class="well">
				<div class="row">
					<span class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
						<img src="<%=room.img%>" class="img img-thumbnail img-responsive room-img"/>
						<h2 class="bottomleft"><%=room.room_name%></h2>
					</span>
				</div>
				<hr>
				<div class="row" id="mlistDevice">
				<% if(listDeviceRoom.length==0){%>
					<div class="col-xs-4"> No device is used</div>
					<div class="col-xs-8">
					<button class="btn btn-default pull-right" id="btnEdit" title="Edit room">Edit</button>
					<button class="btn btn-success pull-right" id="btnSave" title="Done">Done</button>
					</div>
				<%}else{%>
				<div class="col-xs-12">
					<button class="btn btn-default pull-right" id="btnEdit" title="Edit room">Edit</button>
					<button class="btn btn-success pull-right" id="btnSave" title="Done">Done</button>
					</div>
				<%	for(var i = 0; i<listDeviceRoom.length; i++){
					var device = listDeviceRoom[i];
				%>
					<div class="col-lg-2 col-md-2 col-sm-3 col-xs-4">
						<div class="thumbnail" onclick="img_click(this)">
							<i class="fa fa-times-circle fa-2x close" onclick="remove_device(this)"></i>
							<input type="hidden" value="<%=device._id%>">
							<img src="<%=device.device.img%>" style="width:100%" class="img-circle<%if(device.status==false){%> item-off<%}%>">
							<figcaption class="text-border caption"><%=device.device_name%></figcaption>
						</div>
					</div>
				<%}}%>
				</div>
			</div>
		</div>
	</div>
	<% include ./partials/footer %>
</body>
<script  type="text/javascript">
	$(document).ready(function(){
		$(".close").hide();
		$("#btnSave").hide();
	});
	$('#btnEdit').click(function(){
		$(".close").show();
		$("#btnSave").show();
		$('#btnEdit').hide();
	});
	$("#btnSave").click(function(){
		$(".close").hide();
		$("#btnSave").hide();
		$('#btnEdit').show();
	});
	
	function remove_device(e){
		var item = $(e).parent();
		$.ajax({
			url: '/device/removeroom',
			type: 'DELETE',
			data: {'id': item.children('input').val()},
			success: function(data){
				if(data.success==true){
					item.remove();
				}else{
					alert(data.message);
				}
			},
			error: function(){
				alert('Error! An error occurred. Please try again later');
			}
		});
	}
</script>
</html>
